// Code generated by fassify DO NOT EDIT
package server

import (
	"embed"
	"net/http"
	"time"

	"github.com/andygeiss/faasify/internal/http/server/functions/status"
)

//go:embed static
var staticFS embed.FS

//go:generate go run ../../../cmd/update-functions/main.go

func router() (mux *http.ServeMux) {
	stats := &statistics{
		counter:      make(map[string]uint64),
		responseTime: make(map[string]time.Duration),
	}
	mux = http.NewServeMux()
	mux.HandleFunc("/function/status", WithAuthentication(WithLogging(WithStatistics(stats, status.HandlerFunc()))))

	mux.HandleFunc("/stats/", statsHandler(stats))
	mux.Handle("/static/", http.FileServer(http.FS(staticFS)))
	return
}
