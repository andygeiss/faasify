// Code generated by fassify DO NOT EDIT
package server

import (
	"embed"
	"net/http"

	"github.com/andygeiss/faasify/internal/config"
	"github.com/andygeiss/faasify/internal/http/server/functions/hello"
	"github.com/andygeiss/faasify/internal/http/server/functions/index"
	"github.com/andygeiss/faasify/internal/http/server/functions/private"
)

//go:embed bundle
var embedFS embed.FS

//go:generate go run ../../../cmd/update-functions/main.go

func router(cfg *config.Config) (mux *http.ServeMux) {
	// Init multiplexer
	mux = http.NewServeMux()

	// Set generated security token
	cfg.Token = "miTV9J5IU5bCJ75ebmihlFzNw2s4gOcA74TM9UZfC9M="
	cfg.AccountAccess.CreateAccount("faasify", "f44s1fy")

	// Add functions
	mux.HandleFunc("/hello", WithAuthentication(cfg, WithLogging(hello.HandlerFunc(cfg))))

	mux.HandleFunc("/private", WithAuthentication(cfg, WithLogging(private.HandlerFunc(cfg))))

	// Unsecure per default
	mux.HandleFunc("/index", WithLogging(index.HandlerFunc(cfg)))

	// Serve embedded files
	mux.HandleFunc("/", WithEmbeddedFiles(embedFS, "bundle"))
	return
}
