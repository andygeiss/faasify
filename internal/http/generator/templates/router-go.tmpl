// Code generated by fassify DO NOT EDIT
package server

import (
	"embed"
    "io/fs"
	"net/http"
)

//go:embed bundle
var embedFS embed.FS

//go:generate go run ../../../cmd/update-functions/main.go

const Token = "{{ .Token }}"

func router() (mux *http.ServeMux) {
    // Init multiplexer
	mux = http.NewServeMux()

    // Add functions
    {{ range .Functions }}{{ if ne . "index" }}mux.HandleFunc("/{{ . }}", WithAuthentication(WithLogging(WithStatistics({{ . }}.HandlerFunc()))))
    {{ end }}{{ end }}
    // Serve statistics
    mux.HandleFunc("/index", WithLogging(index.HandlerFunc(Token)))
    mux.HandleFunc("/stats", WithAuthentication(WithLogging(statsHandler())))

    // Serve embedded files
    mux.HandleFunc("/", WithEmbeddedFiles(embedFS, "bundle"))
	return
}
