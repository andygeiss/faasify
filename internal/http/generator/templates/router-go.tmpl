// Code generated by fassify DO NOT EDIT
package server

import (
	"embed"
    "io/fs"
	"net/http"
)

//go:embed bundle
var embedFS embed.FS

//go:generate go run ../../../cmd/update-functions/main.go

var Domain string
const Token = "{{ .Token }}"
var Url string

func router() (mux *http.ServeMux) {
    // Init multiplexer
	mux = http.NewServeMux()

    // Add functions
    {{ range .Functions }}{{ if ne . "index" }}mux.HandleFunc("/{{ . }}", WithAuthentication(WithLogging(WithStatistics({{ . }}.HandlerFunc(Token, Domain, Url)))))
    {{ end }}{{ end }}
    // Serve statistics
    mux.HandleFunc("/index", WithLogging(WithStatistics(index.HandlerFunc(Token))))
    mux.HandleFunc("/stats", WithAuthentication(WithLogging(WithStatistics(statsHandler()))))

    // Serve embedded files
    mux.HandleFunc("/", WithEmbeddedFiles(embedFS, "bundle"))
	return
}
